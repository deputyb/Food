{"version":3,"sources":["apps/wegmans/common/js/helpers/globals.js","apps/wegmans/common/js/helpers/utils.js","apps/wegmans/components/content/carousel/clientlibs/carousel.js","apps/wegmans/components/content/responsive-image/clientlibs/responsive-image.js","apps/wegmans/components/content/rss-feed/clientlibs/rss-feed.js","apps/wegmans/common/js/helpers/loader.js","apps/wegmans/common/js/custom/init.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtEA;AACA","file":"scripts.js","sourcesContent":["/**\n * Globals namespace\n * @type {globals|*|{}}\n */\nvar globals = globals || {};\nvar wegmans = wegmans || {};\n\n/**\n * Backbone globals\n */\nwegmans.views = wegmans.views || {};\nwegmans.models = wegmans.models || {};\nwegmans.collections = wegmans.collections || {};\nwegmans.routers = wegmans.routers || {};\n\n\n/**\n * Underscore JSP override\n */\n_.templateSettings = {\n    evaluate:    /\\{\\{(.+?)\\}\\}/g,\n    interpolate: /\\{\\{=(.+?)\\}\\}/g,\n    escape:      /\\{\\{-(.+?)\\}\\}/g\n};\n\n","/**\n * Example usage for globals\n * this global util returning currency number with comma\n * example: 1200 = 1,200\n */\nglobals.formatCurrency = function (number) {\n    'use strict';\n\n    return number.toLocaleString();\n};\n","/*\n * Copyright 1997-2010 Day Management AG\n * Barfuesserplatz 6, 4001 Basel, Switzerland\n * All Rights Reserved.\n *\n * This software is the confidential and proprietary information of\n * Day Management AG, (\"Confidential Information\"). You shall not\n * disclose such Confidential Information and shall use it only in\n * accordance with the terms of the license agreement you entered into\n * with Day.\n */\n(function($) {\n    $(function () {\n\n        function removeHash(context) {\n            try {\n                if (window.location.hash.length > 0 && $(window.location.hash, context).length > 0) {\n                    window.location = (window.location+'').replace(window.location.hash, '');\n                }\n            } catch (e) {\n                errorLog(e, 'Could not remove hash');\n            }\n        }\n\n\n        // Used to output caught errors\n        function errorLog(error, message) {\n            try {\n                if ($.cq.isAuthor() || window.location.hash == '#debug') {\n                    if (typeof console != 'undefined' && typeof console.log  != 'undefined') {\n                        console.log(error);\n                        console.log(message);\n                    }\n                    alert(error.name+':\\n'+error.message+'.\\n'+message+'.');\n                }\n            } catch (e) { }\n        }\n\n        try {\n            // Opacity fading conflicts in IE8 with the PNG fix and text anti-aliasing\n            var fadingSpeed = $.browser.msie ? 0 : 250;\n\n            // Removes the URL hash if it corresponds to the id of an element in the given context\n\n\n            // carousel code\n            try {\n                $('.cq-carousel').each(function () {\n                    var carousel = $(this);\n                    var playDelay = +$(\"var[title='play-delay']\", this).text();\n                    if (!playDelay) {\n                        playDelay = 6000;\n                    }\n                    var slidingSpeed = +$(\"var[title='transition-time']\", this).text();\n                    if (!slidingSpeed) {\n                        slidingSpeed = 1000;\n                    }\n                    var banners = $('.cq-carousel-banners', this);\n                    //do not why, but\n                    // var links = $('.cq-carousel-banner-switch a', this);\n                    //returns more links than expected after component reload. Changed to \"find\" = works......\n                    var switcher = $('.cq-carousel-banner-switch', this);\n                    var links = switcher.find('a');\n                    var items = $('.cq-carousel-banner-item', this);\n                    var width = items.outerWidth();\n                    var itemActive = items.filter(':first');\n                    var itemPrevious = null;\n                    var interval = null;\n                    var i = 0;\n\n                    var ctlPrev = $('a.cq-carousel-control-prev', this);\n                    ctlPrev.click(function() {\n                        if (ctlPrev.is('.cq-carousel-active')) {\n                            $(links[(i+links.length-1)%links.length]).click();\n                        }\n                        return false;\n                    });\n                    var ctlNext = $('a.cq-carousel-control-next', this);\n                    ctlNext.click(function() {\n                        if (ctlNext.is('.cq-carousel-active')) {\n                            $(links[(i+1)%links.length]).click();\n                        }\n                        return false;\n                    });\n                    if (links.length > 1) {\n                        ctlNext.addClass('cq-carousel-active');\n                    }\n                    function play() {\n                        stop();\n                        if( playDelay > 0) {\n                            interval = setInterval(function () {\n                                $(links[(i+1)%links.length]).click();\n                            }, playDelay);\n                        }\n                    }\n                    function stop() {\n                        if (interval !== null) {\n                            clearInterval(interval);\n                            interval = null;\n                        }\n                    }\n\n                    // Show first item (needed for browsers that don't support CSS3 selector :first-of-type)\n                    if (fadingSpeed || $.browser.version > 6) {\n                        itemActive.css('left', 0);\n                    } else {\n                        itemActive.show();\n                    }\n\n                    links\n                        .click(function () {\n                            var link = $(this);\n                            var itemNew = items.filter(link.attr('href'));\n                            var j = itemNew.prevAll().length;\n                            var direction = (j > i || interval !== null) ? 1 : -1;\n\n                            if (!link.is('.cq-carousel-active')) {\n                                links.removeClass('cq-carousel-active');\n                                link.addClass('cq-carousel-active');\n\n                                if (itemActive.is(':animated')) {\n                                    itemActive.stop(true, true);\n                                    itemPrevious.stop(true, true);\n                                }\n\n                                if (fadingSpeed) {\n                                    itemNew.css({'left': direction*width}).animate({'left': 0, 'opacity': 1}, slidingSpeed);\n                                    itemActive.animate({'left': -direction*width, 'opacity': 0}, slidingSpeed);\n                                } else if ($.browser.version > 6) {\n                                    itemNew.css({'left': direction*width, opacity: 1}).animate({'left': 0}, slidingSpeed);\n                                    itemActive.animate({'left': -direction*width}, slidingSpeed);\n                                } else {\n                                    itemNew.fadeIn();\n                                    itemActive.fadeOut();\n                                }\n\n                                itemPrevious = itemActive;\n                                itemActive = itemNew;\n                                i = j;\n                                if (i > 0) {\n                                    ctlPrev.addClass('cq-carousel-active');\n                                } else {\n                                    ctlPrev.removeClass('cq-carousel-active');\n                                }\n                                if (i < links.length-1) {\n                                    ctlNext.addClass('cq-carousel-active');\n                                } else {\n                                    ctlNext.removeClass('cq-carousel-active');\n                                }\n                            }\n\n                            return false;\n                        })\n                        .each(function () {\n                            var link = $(this);\n\n                            link.attr('title', link.text());\n                        })\n                        .filter(':first').addClass('cq-carousel-active');\n\n                    play();\n                    carousel.hover(\n                            function() {\n                                stop();\n                                ctlPrev.fadeIn();\n                                ctlNext.fadeIn();\n                            },\n                            function() {\n                                play();\n                                ctlPrev.fadeOut();\n                                ctlNext.fadeOut();\n                            }\n                    );\n\n                    // Accessing the page with the anchor of a banner in the URL can break the layout\n                    removeHash(this);\n                });\n            } catch (e) {\n                errorLog(e, 'Could not initialize the banners');\n            }\n        } catch (e) {\n            errorLog(e, 'Init failed');\n        }\n    });\n})($CQ || $);","\n(function($) {\n    'use strict';\n    /**\n     * @private\n     */\n    function deepCss(who, css, ps) {\n        var sty, dv = document.defaultView;\n        if (document.body.currentStyle) {\n            sty = css.replace(/\\-([a-z])/g, function(a, b) {\n                return b.toUpperCase();\n            });\n            return who.currentStyle[sty];\n        }\n        if (dv) {\n            dv = document.defaultView.getComputedStyle(who, ps);\n            return dv.getPropertyValue(css);\n        }\n        return '';\n    }\n    /**\n     * @private\n     */\n    function getWindowDimension(d) {\n        var firstChar = d.charAt(0).toUpperCase();\n        var chars = d.split('');\n        chars[0] = firstChar;\n        d = chars.join('');\n        if (typeof window.innerWidth != 'undefined') {\n            return window['inner' + d];\n        } else {\n            if (typeof document.documentElement != 'undefined' && typeof document.documentElement.clientWidth != 'undefined' && document.documentElement.clientWidth !== 0) {\n                return document.documentElement['client' + d];\n            }\n        }\n        return 0;\n    }\n    /**\n     * @private\n     */\n    function getWindowSizeEx(unitOfMeasurement) {\n        if (unitOfMeasurement === 'px') {\n            return getWindowDimension('width');\n        }\n        var fontSizeInPx = deepCss(document.body, 'font-size');\n        if (fontSizeInPx.indexOf('px') === -1) {\n            var fontSizeValue = parseInt(fontSizeInPx, 10) / 100;\n            var numericValue = 16 * fontSizeValue;\n            fontSizeInPx = numericValue + 'px';\n        }\n        var fontSize = parseInt(fontSizeInPx, 10);\n        var width = getWindowDimension('width');\n        var widthInEms = Math.floor(width / fontSize);\n        return widthInEms;\n    }\n\n    /**\n     * The handler used by each component when the window changes size. Be sure\n     * to remove this when you are done!\n     *\n     * @private\n     */\n    function resizeHandler(evt) {\n        var self = evt.data;\n        var resizeTimeout = null;\n        var period = 250;\n        if (resizeTimeout !== null) {\n            window.clearTimeout(resizeTimeout);\n            resizeTimeout = window.setTimeout(function() {\n                self.render();\n                resizeTimeout = null;\n            }, period);\n        } else {\n            self.render();\n            resizeTimeout = window.setTimeout(function() {\n                resizeTimeout = null;\n            }, period);\n        }\n    }\n\n    /**\n     * @constructor\n     */\n    function ResponsiveImage() {\n        this.units = 'px';\n        if (arguments.length === 3) {\n            this.init.apply(this, arguments);\n        }\n    }\n    /**\n     * @param {String|DOMElement|jQueryElement} el\n     * @param {Array<Number>} breakpoints Should be 2 breakpoints, but may work with more.\n     * @param {Array<String>} srcs Array of image path strings. The length of this array should breakpoints.length + 1.\n     */\n    ResponsiveImage.prototype.init = function(el, breakpoints, srcs) {\n        breakpoints.unshift(0);\n        this.el = $(el);\n        this.breakpoints = breakpoints;\n        this.srcs = srcs;\n        this.breakpointsLen = this.breakpoints.length;\n        this.render();\n        $(window).on('resize', this, resizeHandler);\n    };\n    /**\n     * Clean up the component, especially the handler.\n     */\n    ResponsiveImage.prototype.dispose = function() {\n        $(window).off('resize', resizeHandler);\n        this.el = null;\n        this.breakpoints = null;\n        this.srcs = null;\n        this.breakpointsLen = null;\n    };\n    /**\n     * Renders the image according to the rules.\n     */\n    ResponsiveImage.prototype.render = function() {\n        var winSize = getWindowSizeEx(this.units);\n        var src = '';\n        for (var index = 0; index < this.breakpointsLen; index++) {\n            var breakpoint = this.breakpoints[index];\n            if (winSize >= breakpoint) {\n                src = this.srcs[index];\n            } else {\n                break;\n            }\n        }\n        this.el.attr('src', src);\n    };\n\n    $.ResponsiveImage = ResponsiveImage;\n\n    // This will happen later.\n    $(function() {\n\n        /**\n         * Description\n         * @param {String} path A path passed in by jcr.\n         * @return {Boolean} If path is valid.\n         */\n        function validImagePath(path) {\n            return (path.length > 0) && (path !== 'Placeholder');\n        }\n\n        /**\n         * Description\n         * @param {DOMElement} parentDiv Wrapper for a \"responsive-image\" component. This wrapper contains the div declared in JSP.\n         */\n        function initResponsiveImage(parentDiv) {\n            parentDiv = $($(parentDiv).find('div')[0]);\n            // TODO: add params for breakpoint array\n            var mobileImage = parentDiv.attr('mobileImagePath');\n            var tabletImage = parentDiv.attr('tabletImagePath');\n            var desktopImage = parentDiv.attr('desktopImagePath');\n            var selector = $(parentDiv.find('img')[0]);\n            if (validImagePath(mobileImage) && validImagePath(tabletImage) && validImagePath(desktopImage)) {\n                if (!selector.data('initialized')) {\n                    var instance = new $.ResponsiveImage(selector, [480, 768], [mobileImage, tabletImage,\n                        desktopImage\n                    ]);\n                    instance.render();\n                    selector.data('initialized', true);\n                }\n            } else {\n                selector.css('min-height', '64px');\n                selector.css('min-width', '64px');\n            }\n        }\n        var components = $(\".responsive-image\");\n        // Loop through every component of class 'responsive-image'.\n        for (var index = 0; index < components.length; index++) {\n            var component = components[index];\n            initResponsiveImage(component);\n        }\n    });\n\n    return ResponsiveImage;\n}(window.jQuery));","/*global CQ_Analytics, CQ_Analytics.Sitecatalyst */\n$(document).ready(function () {\n    \"use strict\";\n\n    var rssfeedElement = $('#rssfeed');\n    var feedUrl = rssfeedElement.data('feed-url');\n    var noOfItems = rssfeedElement.data('nbr-items');\n    var showFullStory = rssfeedElement.data('full-articles');\n\n\n    $.ajax({\n        url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=' + noOfItems +\n             '&callback=?&q=' + encodeURIComponent(feedUrl),\n        dataType: 'json',\n        success: function (data) {\n            /** @namespace data.responseData.feed */\n            var channel = data.responseData.feed.entries;\n            $.each(channel, function (index, item) {\n                if (item.title) {\n                    rssfeedElement.append($('<h3/>').html(item.title));\n                }\n                if (item.author && showFullStory) {\n                    rssfeedElement.append($('<h4/>').html(item.author));\n                }\n                if (item.title && showFullStory) {\n                    rssfeedElement.append($('<p/>').html(item.content));\n                }\n            });\n            var componentPath = rssfeedElement.data('component-path');\n            tracking(componentPath, feedUrl, noOfItems, showFullStory);\n        }\n    });\n\n    function tracking(componentPath, url, items, showFull) {\n        /** @namespace CQ_Analytics.Sitecatalyst */\n        if (CQ_Analytics.Sitecatalyst) {\n            CQ_Analytics.record({\n                event: 'feed',\n                values: {\n                    rssFeedURL: url,\n                    noOfItems: items,\n                    showFullStory: showFull\n                },\n                componentPath: componentPath\n            });\n        }\n    }\n});\n","/**\n * @author Salvatore Randazzo\n */\n\n(function ($, wegmans) {\n    'use strict';\n\n    /**\n     * Loader\n     * @returns {{init: Function}}\n     * @constructor\n     */\n\n    var Loader = function () {\n        var components = null;\n        var view = '';\n        var model = '';\n        var collection = '';\n        var viewsInstances = [];\n\n\n        /**\n         * Initializer\n         */\n        var init = function () {\n\n            components = $('[data-view]');\n\n            _.each(components, function (component) {\n                view =  $(component).attr('data-view');\n                model = $(component).attr('data-model');\n                collection = $(component).attr('data-collection');\n\n                if (wegmans.views[view] !== undefined) {\n\n\n                    if (collection === undefined) {\n                        viewsInstances.push(new wegmans.views[view]({\n                            el: $(component),\n                            model: wegmans.models[model] !== undefined ? new wegmans.models[model]() : null\n                        }));\n                    } else {\n                        viewsInstances.push(new wegmans.views[view]({\n                            el: $(component),\n                            collection: wegmans.collections[collection] !== undefined ? new wegmans.collections[collection]() : null\n                        }));\n                    }\n\n\n                } else {\n                    throw new Error ('No view found for ' + view );\n                }\n\n            });\n\n\n        };\n\n        // Public\n        return {\n            init: init,\n            viewInstances: viewsInstances\n        };\n    };\n\n    // Starting the application\n    window.loader = new Loader();\n    window.loader.init();\n\n})(jQuery, wegmans);\n","//console.log('---> INIT Welcome');\n//$(document).foundation();"],"sourceRoot":"/source/"}